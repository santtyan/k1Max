2025-07-10 20:11:52,110 - INFO - --- Iniciando fluxo de automação para G-code: C:\Users\leite\OneDrive\Área de Trabalho\Klipper\Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-10 20:11:54,167 - ERROR - Erro ao conectar ao Moonraker do simulador via HTTP: HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000024B8F88A630>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-10 20:11:54,167 - CRITICAL - Não foi possível conectar à Moonraker do simulador. Verifique se o Docker está rodando e o simulador está acessível.
2025-07-10 20:26:47,726 - INFO - --- Iniciando fluxo de automação para G-code: C:\Users\leite\OneDrive\Área de Trabalho\Klipper\Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-10 20:26:49,769 - ERROR - Erro ao conectar ao Moonraker do simulador via HTTP: HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000019F879D3530>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-10 20:26:49,769 - CRITICAL - Não foi possível conectar à Moonraker do simulador. Verifique se o Docker está rodando e o simulador está acessível.
2025-07-10 20:58:45,574 - INFO - --- Iniciando fluxo de automação para G-code: C:/Users/leite/OneDrive/Área de Trabalho/Klipper/Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-10 20:58:47,607 - ERROR - Erro ao conectar ao Moonraker do simulador via HTTP: HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EE28F3A720>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-10 20:58:47,607 - CRITICAL - Não foi possível conectar à Moonraker do simulador. Verifique se o Docker está rodando e o simulador está acessível.
2025-07-10 21:02:51,666 - INFO - --- Iniciando fluxo de automação para G-code: C:/Users/leite/OneDrive/Área de Trabalho/Klipper/Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-10 21:02:51,666 - INFO - Tentativa 1/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-10 21:02:53,707 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 1): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001A7E6661F40>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-10 21:02:53,707 - INFO - Aguardando 1 segundos antes de tentar novamente...
2025-07-10 21:02:54,718 - INFO - Tentativa 2/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-10 21:02:56,747 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 2): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001A7E92F2600>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-10 21:02:56,747 - INFO - Aguardando 2 segundos antes de tentar novamente...
2025-07-10 21:02:58,760 - INFO - Tentativa 3/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-10 21:03:00,780 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 3): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001A7E87AF5C0>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-10 21:03:00,781 - CRITICAL - Todas as 3 tentativas de GET para http://127.0.0.1:7125/server/info falharam. Abortando.
2025-07-10 21:03:00,781 - CRITICAL - Não foi possível conectar à Moonraker do simulador. Verifique se o Docker está rodando e o simulador está acessível.
2025-07-14 07:51:31,753 - CRITICAL - Erro: O caminho do arquivo G-code não foi fornecido como argumento de linha de comando.
2025-07-14 07:51:31,753 - CRITICAL - Uso correto: python automacao_k1max.py "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\Peca T2_PLA_2h29m.gcode"
2025-07-14 07:51:53,062 - INFO - --- Iniciando fluxo de automação para G-code: C:/Users/leite/OneDrive/Área de Trabalho/Klipper/Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-14 07:51:53,062 - INFO - Tentativa 1/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-14 07:51:55,119 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 1): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001B27D559A30>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-14 07:51:55,119 - INFO - Aguardando 1 segundos antes de tentar novamente...
2025-07-14 07:51:56,122 - INFO - Tentativa 2/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-14 07:51:58,143 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 2): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001B27D55A870>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-14 07:51:58,143 - INFO - Aguardando 2 segundos antes de tentar novamente...
2025-07-14 07:52:00,153 - INFO - Tentativa 3/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-14 07:52:02,177 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 3): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001B27CCCCE90>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-14 07:52:02,177 - CRITICAL - Todas as 3 tentativas de GET para http://127.0.0.1:7125/server/info falharam. Abortando.
2025-07-14 07:52:02,177 - CRITICAL - Não foi possível conectar à Moonraker do simulador. Verifique se o Docker está rodando e o simulador está acessível.
2025-07-14 07:52:12,303 - INFO - --- Iniciando fluxo de automação para G-code: C:/Users/leite/OneDrive/Área de Trabalho/Klipper/Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-14 07:52:12,303 - INFO - Tentativa 1/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-14 07:52:14,327 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 1): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001A4FF71A120>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-14 07:52:14,327 - INFO - Aguardando 1 segundos antes de tentar novamente...
2025-07-14 07:52:15,335 - INFO - Tentativa 2/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-14 07:52:17,382 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 2): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001A4FF71A780>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-14 07:52:17,382 - INFO - Aguardando 2 segundos antes de tentar novamente...
2025-07-14 07:52:19,395 - INFO - Tentativa 3/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-14 07:52:21,430 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 3): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001A4FEAEDA30>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-14 07:52:21,430 - CRITICAL - Todas as 3 tentativas de GET para http://127.0.0.1:7125/server/info falharam. Abortando.
2025-07-14 07:52:21,430 - CRITICAL - Não foi possível conectar à Moonraker do simulador. Verifique se o Docker está rodando e o simulador está acessível.
2025-07-14 07:58:41,165 - INFO - --- Iniciando fluxo de automação para G-code: C:/Users/leite/OneDrive/Área de Trabalho/Klipper/Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-14 07:58:41,165 - INFO - Tentativa 1/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-14 07:58:43,248 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 1): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001D0DEB99A30>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-14 07:58:43,248 - INFO - Aguardando 1 segundos antes de tentar novamente...
2025-07-14 07:58:44,262 - INFO - Tentativa 2/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-14 07:58:46,296 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 2): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001D0DEB9A870>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-14 07:58:46,296 - INFO - Aguardando 2 segundos antes de tentar novamente...
2025-07-14 07:58:48,301 - INFO - Tentativa 3/3 de GET para http://127.0.0.1:7125/server/info...
2025-07-14 07:58:50,363 - WARNING - Erro na requisição para http://127.0.0.1:7125/server/info (tentativa 3): HTTPConnectionPool(host='127.0.0.1', port=7125): Max retries exceeded with url: /server/info (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001D0DE2FCE90>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente'))
2025-07-14 07:58:50,363 - CRITICAL - Todas as 3 tentativas de GET para http://127.0.0.1:7125/server/info falharam. Abortando.
2025-07-14 07:58:50,364 - CRITICAL - Não foi possível conectar à Moonraker do simulador. Verifique se o Docker está rodando e o simulador está acessível.
2025-07-14 12:53:55,305 - INFO - --- Iniciando fluxo de automação para G-code: C:/Users/leite/OneDrive/Área de Trabalho/Klipper/Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-14 12:53:55,306 - INFO - MODO MOCKING ATIVO: Simulação de resposta para GET http://127.0.0.1:7125/server/info
2025-07-14 12:53:55,306 - INFO - Conexão com Moonraker do simulador bem-sucedida. Versão: 2.0.0-mock
2025-07-14 12:53:55,306 - INFO - MODO MOCKING ATIVO: Simulação de resposta para GET http://127.0.0.1:7125/printer/objects/query?full=true&websockets=false
2025-07-14 12:53:55,306 - INFO - Impressora está no estado 'ready'. Pronta para operação.
2025-07-14 12:53:55,306 - INFO - MODO MOCKING ATIVO: Simulação de resposta para POST http://127.0.0.1:7125/server/files/upload
2025-07-14 12:53:55,306 - INFO - Upload de 'Peca T2_PLA_2h29m.gcode' para o simulador concluído com sucesso.
2025-07-14 12:53:55,322 - CRITICAL - Erro inesperado no fluxo de automação do simulador: BaseEventLoop.create_connection() got an unexpected keyword argument 'timeout'
Traceback (most recent call last):
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\automacao_k1max.py", line 273, in automate_k1max_printing_workflow
    async with websockets.connect(WS_URL_BASE, timeout=15) as websocket:
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 587, in __aenter__
    return await self
           ^^^^^^^^^^
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 541, in __await_impl__
    self.connection = await self.create_connection()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 467, in create_connection
    _, connection = await loop.create_connection(factory, **kwargs)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: BaseEventLoop.create_connection() got an unexpected keyword argument 'timeout'
2025-07-14 12:55:48,100 - INFO - --- Iniciando fluxo de automação para G-code: C:/Users/leite/OneDrive/Área de Trabalho/Klipper/Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-14 12:55:48,101 - INFO - MODO MOCKING ATIVO: Simulação de resposta para GET http://127.0.0.1:7125/server/info
2025-07-14 12:55:48,101 - INFO - Conexão com Moonraker do simulador bem-sucedida. Versão: 2.0.0-mock
2025-07-14 12:55:48,101 - INFO - MODO MOCKING ATIVO: Simulação de resposta para GET http://127.0.0.1:7125/printer/objects/query?full=true&websockets=false
2025-07-14 12:55:48,101 - INFO - Impressora está no estado 'ready'. Pronta para operação.
2025-07-14 12:55:48,104 - INFO - MODO MOCKING ATIVO: Simulação de resposta para POST http://127.0.0.1:7125/server/files/upload
2025-07-14 12:55:48,105 - INFO - Upload de 'Peca T2_PLA_2h29m.gcode' para o simulador concluído com sucesso.
2025-07-14 12:55:50,195 - CRITICAL - Erro inesperado no fluxo de automação do simulador: [WinError 1225] O computador remoto recusou a conexão de rede
Traceback (most recent call last):
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\automacao_k1max.py", line 273, in automate_k1max_printing_workflow
    async with websockets.connect(WS_URL_BASE) as websocket: # <--- REMOVIDO 'timeout=15'
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 587, in __aenter__
    return await self
           ^^^^^^^^^^
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 541, in __await_impl__
    self.connection = await self.create_connection()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 467, in create_connection
    _, connection = await loop.create_connection(factory, **kwargs)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 729, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 803, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] O computador remoto recusou a conexão de rede
2025-07-14 13:13:04,764 - INFO - --- Iniciando fluxo de automação para G-code: C:/Users/leite/OneDrive/Área de Trabalho/Klipper/Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-14 13:13:04,772 - INFO - MODO MOCKING ATIVO: Simulação de resposta para GET http://127.0.0.1:7125/server/info
2025-07-14 13:13:04,772 - INFO - Conexão com Moonraker do simulador bem-sucedida. Versão: 2.0.0-mock
2025-07-14 13:13:04,772 - INFO - MODO MOCKING ATIVO: Simulação de resposta para GET http://127.0.0.1:7125/printer/objects/query?full=true&websockets=false
2025-07-14 13:13:04,772 - INFO - Impressora está no estado 'ready'. Pronta para operação.
2025-07-14 13:13:04,774 - INFO - MODO MOCKING ATIVO: Simulação de resposta para POST http://127.0.0.1:7125/server/files/upload
2025-07-14 13:13:04,774 - INFO - Upload de 'Peca T2_PLA_2h29m.gcode' para o simulador concluído com sucesso.
2025-07-14 13:13:06,848 - CRITICAL - Erro inesperado no fluxo de automação do simulador: [WinError 1225] O computador remoto recusou a conexão de rede
Traceback (most recent call last):
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\automacao_k1max.py", line 273, in automate_k1max_printing_workflow
    async with websockets.connect(WS_URL_BASE) as websocket: # <--- REMOVIDO 'timeout=15'
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 587, in __aenter__
    return await self
           ^^^^^^^^^^
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 541, in __await_impl__
    self.connection = await self.create_connection()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 467, in create_connection
    _, connection = await loop.create_connection(factory, **kwargs)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 729, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 803, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] O computador remoto recusou a conexão de rede
2025-07-14 13:39:52,888 - INFO - --- Iniciando fluxo de automação para G-code: C:/Users/leite/OneDrive/Área de Trabalho/Klipper/Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-14 13:39:52,889 - INFO - MODO MOCKING ATIVO: Simulação de resposta para GET http://127.0.0.1:7125/server/info
2025-07-14 13:39:52,889 - INFO - Conexão com Moonraker do simulador bem-sucedida. Versão: 2.0.0-mock
2025-07-14 13:39:52,889 - INFO - MODO MOCKING ATIVO: Simulação de resposta para GET http://127.0.0.1:7125/printer/objects/query?full=true&websockets=false
2025-07-14 13:39:52,889 - INFO - Impressora está no estado 'ready'. Pronta para operação.
2025-07-14 13:39:52,890 - INFO - MODO MOCKING ATIVO: Simulação de resposta para POST http://127.0.0.1:7125/server/files/upload
2025-07-14 13:39:52,890 - INFO - Upload de 'Peca T2_PLA_2h29m.gcode' para o simulador concluído com sucesso.
2025-07-14 13:39:54,948 - CRITICAL - Erro inesperado no fluxo de automação do simulador: [WinError 1225] O computador remoto recusou a conexão de rede
Traceback (most recent call last):
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\automacao_k1max.py", line 251, in automate_k1max_printing_workflow
    async with websockets.connect(WS_URL_BASE) as websocket:
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 587, in __aenter__
    return await self
           ^^^^^^^^^^
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 541, in __await_impl__
    self.connection = await self.create_connection()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 467, in create_connection
    _, connection = await loop.create_connection(factory, **kwargs)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 729, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 803, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] O computador remoto recusou a conexão de rede
2025-07-14 13:43:02,122 - INFO - --- Iniciando fluxo de automaçao para G-code: C:/Users/leite/OneDrive/Área de Trabalho/Klipper/Peca T2_PLA_2h29m.gcode no simulador Docker ---
2025-07-14 13:43:02,123 - INFO - MODO MOCKING ATIVO: Simulaçao de resposta para GET http://127.0.0.1:7125/server/info
2025-07-14 13:43:02,123 - INFO - Conexao com Moonraker do simulador bem-sucedida. Versao: 2.0.0-mock
2025-07-14 13:43:02,124 - INFO - MODO MOCKING ATIVO: Simulaçao de resposta para GET http://127.0.0.1:7125/printer/objects/query?full=true&websockets=false
2025-07-14 13:43:02,124 - INFO - Impressora esta no estado 'ready'. Pronta para operaçao.
2025-07-14 13:43:02,124 - INFO - MODO MOCKING ATIVO: Simulaçao de resposta para POST http://127.0.0.1:7125/server/files/upload
2025-07-14 13:43:02,124 - INFO - Upload de 'Peca T2_PLA_2h29m.gcode' para o simulador concluido com sucesso.
2025-07-14 13:43:04,158 - CRITICAL - Erro inesperado no fluxo de automaçao do simulador: [WinError 1225] O computador remoto recusou a conexão de rede
Traceback (most recent call last):
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\automacao_k1max.py", line 251, in automate_k1max_printing_workflow
    async with websockets.connect(WS_URL_BASE) as websocket:
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 587, in __aenter__
    return await self
           ^^^^^^^^^^
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 541, in __await_impl__
    self.connection = await self.create_connection()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\OneDrive\Área de Trabalho\Klipper\venv_k1max_automation\Lib\site-packages\websockets\asyncio\client.py", line 467, in create_connection
    _, connection = await loop.create_connection(factory, **kwargs)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 729, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 803, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\leite\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] O computador remoto recusou a conexão de rede
